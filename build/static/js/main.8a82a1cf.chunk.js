(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{37:function(e,n,t){"use strict";t.r(n);var r=t(0),s=t(1),o=t(14),c=t.n(o),a=t(3),u=t(4),i=t.n(u),d="/api/persons",l=function(){return i.a.get(d).then((function(e){return e.data}))},b=function(e){return i.a.post(d,e).then((function(e){return e.data}))},m=function(e,n){return i.a.put("".concat(d,"/").concat(e),n).then((function(e){return e.data}))},j=function(e){return i.a.delete("".concat(d,"/").concat(e)).then((function(e){return e.data}))},f=function(e){return Object(r.jsxs)("div",{children:[e.person.name," ",e.person.number," ",Object(r.jsx)("button",{onClick:function(){window.confirm("Are you sure you want to delete ".concat(e.person.name,"?"))&&j(e.person.id).then((function(){e.setPersons(e.persons.filter((function(n){return n.id!==e.person.id}))),e.setErrorMessage(["Removed ".concat(e.person.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})).catch((function(n){e.setErrorMessage(["Information of ".concat(e.person.name," has already been removed from server"),!1]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)}))},children:"delete"})]})},h=function(e){return Object(r.jsx)(r.Fragment,{children:e.persons.flatMap((function(n){return n.name.toLowerCase().includes(e.newFilter.toLowerCase())?[Object(r.jsx)(f,{person:n,persons:e.persons,setPersons:e.setPersons,setErrorMessage:e.setErrorMessage},n.name)]:[]}))})},p=function(e){return Object(r.jsxs)("div",{children:["filter shown with"," ",Object(r.jsx)("input",{value:e.newFilter,onChange:function(n){e.setNewFilter(n.target.value)}})]})},g=function(e){return Object(r.jsxs)("form",{onSubmit:function(n){n.preventDefault();var t={name:e.newName,number:e.newNumber};e.persons.map((function(e){return e.name})).includes(e.newName)?window.confirm("".concat(e.newName," is already added to phonebook, replace the old number with a new one?"))&&m(e.persons.filter((function(e){return e.name===t.name}))[0].id,t).then((function(n){e.setPersons(e.persons.map((function(e){return e.name===n.name?n:e}))),e.setNewName(""),e.setNewNumber(""),e.setErrorMessage(["Updated ".concat(n.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})).catch((function(n){e.setErrorMessage(["".concat(n.response.data.error),!1]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})):b(t).then((function(n){e.setPersons(e.persons.concat(n)),e.setNewName(""),e.setNewNumber(""),e.setErrorMessage(["Added ".concat(n.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})).catch((function(n){e.setErrorMessage(["".concat(n.response.data.error),!1]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)}))},children:[Object(r.jsxs)("div",{children:["name: ",Object(r.jsx)("input",{value:e.newName,onChange:function(n){e.setNewName(n.target.value)}})]}),Object(r.jsxs)("div",{children:["number: ",Object(r.jsx)("input",{value:e.newNumber,onChange:function(n){e.setNewNumber(n.target.value)}})]}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{type:"submit",children:"add"})})]})},w=function(e){var n=e.message;return null===n[0]?null:!0===n[1]?Object(r.jsx)("div",{style:{color:"green",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:n}):Object(r.jsx)("div",{style:{color:"red",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:n})},O=function(){var e=Object(s.useState)([]),n=Object(a.a)(e,2),t=n[0],o=n[1],c=Object(s.useState)(""),u=Object(a.a)(c,2),i=u[0],d=u[1],b=Object(s.useState)(""),m=Object(a.a)(b,2),j=m[0],f=m[1],O=Object(s.useState)(""),N=Object(a.a)(O,2),x=N[0],v=N[1],E=Object(s.useState)([null,!0]),M=Object(a.a)(E,2),y=M[0],S=M[1];return Object(s.useEffect)((function(){console.log("fetching persons..."),l().then((function(e){console.log("persons fetched!"),o(e)}))}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Phonebook"}),Object(r.jsx)(w,{message:y}),Object(r.jsx)(p,{newFilter:i,setNewFilter:d}),Object(r.jsx)("h2",{children:"add a new"}),Object(r.jsx)(g,{persons:t,setPersons:o,newName:j,setNewName:f,newNumber:x,setNewNumber:v,setErrorMessage:S}),Object(r.jsx)("h2",{children:"Numbers"}),Object(r.jsx)(h,{persons:t,setPersons:o,newFilter:i,setErrorMessage:S})]})};c.a.render(Object(r.jsx)(O,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.8a82a1cf.chunk.js.map