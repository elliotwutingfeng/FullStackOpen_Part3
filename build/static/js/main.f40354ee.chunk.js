(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{38:function(e,n,t){"use strict";t.r(n);var r=t(1),s=t(14),o=t.n(s),c=t(3),a=t(4),u=t.n(a),i="/api/persons",d=function(){return u.a.get(i).then((function(e){return e.data}))},l=function(e){return u.a.post(i,e).then((function(e){return e.data}))},b=function(e,n){return u.a.put("".concat(i,"/").concat(e),n).then((function(e){return e.data}))},m=function(e){return u.a.delete("".concat(i,"/").concat(e)).then((function(e){return e.data}))},j=t(0),f=function(e){return Object(j.jsxs)("div",{children:[e.person.name," ",e.person.number," ",Object(j.jsx)("button",{onClick:function(){window.confirm("Are you sure you want to delete ".concat(e.person.name,"?"))&&m(e.person.id).then((function(){e.setPersons(e.persons.filter((function(n){return n.id!==e.person.id}))),e.setErrorMessage(["Removed ".concat(e.person.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})).catch((function(n){e.setErrorMessage(["Information of ".concat(e.person.name," has already been removed from server"),!1]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)}))},children:"delete"})]})},h=function(e){return Object(j.jsx)(j.Fragment,{children:e.persons.flatMap((function(n){return n.name.toLowerCase().includes(e.newFilter.toLowerCase())?[Object(j.jsx)(f,{person:n,persons:e.persons,setPersons:e.setPersons,setErrorMessage:e.setErrorMessage},n.name)]:[]}))})},p=function(e){return Object(j.jsxs)("div",{children:["filter shown with"," ",Object(j.jsx)("input",{value:e.newFilter,onChange:function(n){e.setNewFilter(n.target.value)}})]})},g=function(e){return Object(j.jsxs)("form",{onSubmit:function(n){n.preventDefault();var t={name:e.newName,number:e.newNumber};e.persons.map((function(e){return e.name})).includes(e.newName)?window.confirm("".concat(e.newName," is already added to phonebook, replace the old number with a new one?"))&&b(e.persons.filter((function(e){return e.name===t.name}))[0].id,t).then((function(n){e.setPersons(e.persons.map((function(e){return e.name===n.name?n:e}))),e.setNewName(""),e.setNewNumber(""),e.setErrorMessage(["Updated ".concat(n.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})).catch((function(n){e.setErrorMessage(["Information of ".concat(t.name," has already been removed from server"),!1]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)})):l(t).then((function(n){e.setPersons(e.persons.concat(n)),e.setNewName(""),e.setNewNumber(""),e.setErrorMessage(["Added ".concat(n.name),!0]),setTimeout((function(){e.setErrorMessage([null,!0])}),5e3)}))},children:[Object(j.jsxs)("div",{children:["name: ",Object(j.jsx)("input",{value:e.newName,onChange:function(n){e.setNewName(n.target.value)}})]}),Object(j.jsxs)("div",{children:["number: ",Object(j.jsx)("input",{value:e.newNumber,onChange:function(n){e.setNewNumber(n.target.value)}})]}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{type:"submit",children:"add"})})]})},w=function(e){var n=e.message;return null===n[0]?null:!0===n[1]?Object(j.jsx)("div",{style:{color:"green",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:n}):Object(j.jsx)("div",{style:{color:"red",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},children:n})},O=function(){var e=Object(r.useState)([]),n=Object(c.a)(e,2),t=n[0],s=n[1],o=Object(r.useState)(""),a=Object(c.a)(o,2),u=a[0],i=a[1],l=Object(r.useState)(""),b=Object(c.a)(l,2),m=b[0],f=b[1],O=Object(r.useState)(""),N=Object(c.a)(O,2),v=N[0],x=N[1],E=Object(r.useState)([null,!0]),M=Object(c.a)(E,2),y=M[0],S=M[1];return Object(r.useEffect)((function(){console.log("fetching persons..."),d().then((function(e){console.log("persons fetched!"),s(e)}))}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{children:"Phonebook"}),Object(j.jsx)(w,{message:y}),Object(j.jsx)(p,{newFilter:u,setNewFilter:i}),Object(j.jsx)("h2",{children:"add a new"}),Object(j.jsx)(g,{persons:t,setPersons:s,newName:m,setNewName:f,newNumber:v,setNewNumber:x,setErrorMessage:S}),Object(j.jsx)("h2",{children:"Numbers"}),Object(j.jsx)(h,{persons:t,setPersons:s,newFilter:u,setErrorMessage:S})]})};o.a.render(Object(j.jsx)(O,{}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.f40354ee.chunk.js.map